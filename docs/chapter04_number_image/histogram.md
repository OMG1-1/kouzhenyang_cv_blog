# 直方图

直方图是一种统计图表，它可以用来展示一组数据的分布情况。

在图像处理中，经常用到直方图，如颜色直方图、灰度直方图等，直方图常常被用来检测和纠正图像中的噪声或异常值。

## 相关知识和背景

### 统计学和数学基础

直方图是基于统计学的原理，通过计算数据中的某个区间内的数据数量来展示数据的分布情况。
因此，了解基本的统计学和数学知识，如概率论、数理统计等，有助于理解直方图的原理和计算方法。

### 计算机图形学

直方图是一种基于计算机图形学的数据可视化方法，需要使用计算机图形学相关的软件和工具来实现。
了解计算机图形学的知识，如图形库、绘图函数等，有助于掌握直方图的绘制方法和技巧。

### 数据处理和分析

直方图是一种常用的数据可视化方法，可以用于数据处理和分析。
了解数据处理和分析的方法，如数据清洗、数据分析和建模等，有助于利用直方图来发现数据中的规律和异常值。

### 数据可视化和展示

直方图是一种直观的数据可视化方法，可以用于展示数据分布情况。
了解数据可视化和展示的知识，如数据可视化工具、数据展示技巧等，有助于提高数据可视化的效果和质量。

## 直方图的定义

直方图是统计学中一种重要的数据可视化方法，它通过将数据划分为多个区间，并统计每个区间内的数据数量，来展示数据的分布情况。
在图像处理中，直方图常常被用来检测和纠正图像中的噪声或异常值。

## 直方图的性质

- 反映了图像灰度分布规律，描述每个灰度级具有的像素数（但不包含这些像素在图像中的位置信息）。
- 可以作为**图像的特征**（不关心像素的空间信息，因此不受图像旋转和平移操作的影响）。
- 一幅特定图像都有唯一的直方图，但不同的图像的直方图可能相同。
- 直方图的**统计特性**与图像的**几何特性**无关，即直方图的统计特性与图像的形状、大小、旋转和平移操作无关。
- 如果一幅图像有两个不相连的区域组成，则整个图像的直方图是两个区域的直方图之和。

## 直方图的计算

直方图的计算需要对数据进行分组，并统计每个分组中的数据数量。
在图像处理中，直方图的计算方法如下：

1. 将数据划分为多个区间，每个区间称为一个 bin。
2. 统计每个 bin 内的数据数量。

## 直方图的类型

直方图可以分为连续型直方图和离散型直方图。
连续型直方图用于表示连续型数据的分布情况，如时间、温度、压力等。
离散型直方图用于表示离散型数据的分布情况，如颜色、像素值等。

### 连续型直方图

> 表示方法：
>
> 适用于数据分布较为集中的情况，通过将数据分成若干个区间，然后统计每个区间内的数据点数量。
> 每个区间称为一个桶（bucket），数据点的数量称为桶的计数。
>
> 连续直方图的统计结果以一组区间边界列表的形式表示。

### 离散型直方图

> 表示方法：
>
> 适用于数据分布较为均匀的情况，通过将数据分成若干个区间，然后统计每个区间内的数据点数量。
> 每个区间称为一个桶（bucket），数据点的数量称为桶的计数。
>
> 离散直方图的统计结果以一组计数数组的形式表示。

## 直方图的应用

![application.png](histogram.assets%2Fapplication.png)

直方图可以用于检测和纠正图像中的噪声或异常值。
在图像处理中，直方图可以用于检测图像中的暗像素和亮像素，并将其归一化为相同的亮度。

## 直方图均衡化 \*

> 直方图均衡化（Histogram Equalization）是一种常用的图像增强方法，用于提高图像的对比度。

直方图均衡化是将原图像的直方图通过变换函数变为均匀的直方图，然后按均匀直方图修改原图像，从而获得一幅灰度分布均匀的新图像。<u>简而言之就是用一定的算法使直方图大致平和的方法。</u>

为了将原图像的亮度范围进行扩展，需要一个映射函数，将原图像的像素值均衡映射到新直方图中，这个映射函数有两个条件：

1. 为了不打乱原有顺序，映射后亮、暗的大小关系不能改变
2. 映射后必须在原有范围内（0-255）

### 直方图均衡化算法步骤

1. 依次扫描原始灰度图像的每一个像素，计算图像的灰度直方图$H$
2. 计算灰度直方图的累加直方图
3. 根据累加直方图和直方图均衡化原理得到输入与输出之间的映射关系。
4. 最后根据映射关系得到结果：$dst(x,y)=hist(src(x,y))$进行图像变换

### 直方图均衡化原理

对于输入图像的任意一个像素$p$，$p \in [0,255]$，总能在输出图像里有对应的像素$q$，$q \in [0,255]$使的下面的公式（累加直方图公式）成立（输入和输出的像素总量相等）：

$$
\sum_{k=0}^p hist_{input}(k) = \sum_{k=0}^q hist_{output}(k)
$$

其中，输出图像每个灰度级的个数：

$$
hist_{output}(k) \approx  \frac{H*W}{256}, k \in [0,255]
$$

带入累加直方图公式，可以得到：

$$
\sum_{k=0}^p hist_{input}(k) \approx (q+1) * \frac{H*W}{256}
$$

则有：

$$
q = \sum_{k=0}^p \frac{hist_{input}(k)}{H*W}*256-1
$$

### 直方图均衡化的优点

直方图均衡化的优点是：

1. 保持图像的对比度，提高图像的清晰度。
2. 直方图均衡化可以提高图像的对比度，增强图像的鲁棒性。

### 直方图均衡化的缺点

直方图均衡化的缺点是：

1. 直方图均衡化会改变图像的色彩分布，使图像的色彩失真。
2. 直方图均衡化会改变图像的对比度，使图像的对比度失真。
3. 直方图均衡化会改变图像的亮度，使图像的亮度失真。

## 其他关联概念

直方图在数据挖掘、机器学习等领域，直方图也被广泛应用；以下是直方图与其他概念的关联和影响：

> 相关性分析：
>
> 直方图可以用于分析两个变量之间的相关性。通过绘制两个变量的直方图，可以直观地看出它们之间的相关程度。

> 分布分析：
>
> 直方图可以用于分析数据的分布情况。通过绘制数据的直方图，可以了解数据的分布特征，如分布范围、分布密度等。

> 异常值处理：
>
> 直方图可以用于检测数据中的异常值。异常值是指在数据中异常突出的值，它们可能会对数据的分布造成影响。通过绘制数据的直方图，可以找出异常值并对其进行处理。

> 特征工程：
>
> 直方图可以用于数据特征的提取。通过绘制数据的直方图，可以了解数据的分布情况，从而对数据进行归一化、标准化等特征工程处理，以提高模型的准确性。

> 聚类分析：
>
> 直方图可以用于聚类分析。聚类是将相似的数据划分为一组的方法。通过绘制数据的直方图，可以找到数据中的聚类中心，从而对数据进行聚类。

直方图在数据处理和分析中具有广泛的应用和意义，可以帮助我们更好地理解数据、发现数据中的规律和问题，从而提高数据质量和模型效果。
